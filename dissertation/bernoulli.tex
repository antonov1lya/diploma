\subsection{Условная независимость в трехмерном распределение Бернулли}\label{ci_and_bernoulli}
Определим трехмерное распределение Бернулли согласно \cite{Dai2013}, \cite{Teugels1990}.
\begin{definition}
    Случайный вектор $(X,Y,Z)^T$ имеет трехмерное распределение Бернулли,
    если множество его возможных значений:
    $$
        \begin{pmatrix}
            0 \\
            0 \\
            0
        \end{pmatrix},
        \begin{pmatrix}
            0 \\
            0 \\
            1
        \end{pmatrix},
        \begin{pmatrix}
            0 \\
            1 \\
            0
        \end{pmatrix}, \ldots, \begin{pmatrix}
            1 \\
            1 \\
            1
        \end{pmatrix}
    $$ и заданы $P(X=x,Y=y,Z=z)=p_{xyz} \geq 0,  \sum_{x=0}^1 \sum_{y=0}^1 \sum_{z=0}^1 p_{xyz} =1$.
\end{definition}
Приведем определение понятия условной независимости \cite{Lauritzen1996}.
\begin{definition}
    Пусть $(X,Y,Z)^T$ -- дискретный случайный вектор.
    Говорят, что случайные величины $X$ и $Y$ условно независимы при условии $Z$,
    и пишут $X \ci Y \mid Z$, если:
    $$
    P(X=x, Y=y \mid Z = z) = P(X=x \mid Z = z) P(Y=y \mid Z = z)
    $$
    при любом $z$ для которого $P(Z=z)>0$.
\end{definition}
Сформулируем и докажем теорему, которая характеризует соотношения между параметрами трехмерного распределения Бернулли при условной независимости.
\begin{theorem}\label{thm1}
    Пусть $(X,Y,Z)^T$ -- случайный вектор, имеющий трехмерное распределение Бернулли, в котором $P(Z=0)>0$.
    Случайные величины $X$ и $Y$ условно независимы при условии $Z$ тогда и только тогда, когда
    $p_{00z}p_{11z}=p_{01z}p_{10z}$, где $z=\overline{0,1}$.
\end{theorem}
\begin{proof}
    Пусть $X \ci Y \mid Z$. Значит, для любых $x=\overline{0,1}$, $y=\overline{0,1}$ и $z=\overline{0,1}$ выполнено условие:
    \begin{equation}\label{ci_cond}
        P(X=x, Y=y \mid Z = z) = P(X=x \mid Z = z) P(Y=y \mid Z = z)
    \end{equation}
    После домножения \eqref{ci_cond} на $P(Z=z)^2$ получаем эквивалентное условие:
    \begin{equation}\label{ci_cond2}
        P(X=x,Y=y,Z=z)P(Z=z)=P(X=x,Z=z)P(Y=y,Z=z)
    \end{equation}
    Найдем маргинальное распределение случайной величины $Z$:
    $$
        P(Z=z)=\sum_{x=0}^{1} \sum_{y=0}^{1} p_{xyz} = p_{00z} + p_{01z} + p_{10z} + p_{11z}
    $$
    Найдем маргинальные распределения $(X,Z)^T$ и $(Y,Z)^T$:
    $$
        P(X=x, Z=z) = \sum_{y=0}^{1} p_{xyz} = p_{x0z} + p_{x1z}
    $$
    $$
        P(Y=y, Z=z) = \sum_{x=0}^{1} p_{xyz} = p_{0yz} + p_{1yz}
    $$
    Тогда условие \eqref{ci_cond2} перепишем в следующем виде:
    $$
        p_{xyz} (p_{00z} + p_{01z} + p_{10z} + p_{11z}) = (p_{x0z} + p_{x1z}) (p_{0yz} + p_{1yz})
    $$
    Это условие выполняется для всех $x=\overline{0,1}$, $y=\overline{0,1}$, $z=\overline{0,1}$.
    Пусть $z$ фиксировано.
    Если $x=0$ и $y=0$, то:
    $$
        p_{00z} (p_{00z} + p_{01z} + p_{10z} + p_{11z}) = (p_{00z} + p_{01z}) (p_{00z} + p_{10z})
    $$
    $$
        p_{00z} p_{00z} + p_{00z} p_{01z} + p_{00z} p_{10z} + p_{00z} p_{11z} =
        p_{00z} p_{00z} + p_{00z} p_{10z} + p_{01z} p_{00z} + p_{01z} p_{10z}
    $$
    $$
        p_{00z} p_{11z} = p_{01z} p_{10z}
    $$
    Если $x=0$ и $y=1$, то:
    $$
        p_{01z} (p_{00z} + p_{01z} + p_{10z} + p_{11z}) = (p_{00z} + p_{01z}) (p_{01z} + p_{11z})
    $$
    $$
        p_{01z}p_{00z} + p_{01z}p_{01z} + p_{01z}p_{10z} + p_{01z}p_{11z} =
        p_{00z}p_{01z} + p_{00z} p_{11z} + p_{01z} p_{01z} + p_{01z} p_{11z}
    $$
    $$
        p_{01z}p_{10z}=p_{00z} p_{11z}
    $$
    Если $x=1$ и $y=0$, то:
    $$
        p_{10z} (p_{00z} + p_{01z} + p_{10z} + p_{11z}) = (p_{10z} + p_{11z}) (p_{00z} + p_{10z})
    $$
    $$
        p_{10z} p_{00z} + p_{10z} p_{01z} + p_{10z} p_{10z} + p_{10z} p_{11z} = p_{10z}p_{00z} + p_{10z}p_{10z} + p_{11z}p_{00z} + p_{11z}p_{10z}
    $$
    $$
        p_{10z} p_{01z} = p_{11z}p_{00z}
    $$
    Если $x=1$ и $y=1$, то:
    $$
        p_{11z} (p_{00z} + p_{01z} + p_{10z} + p_{11z}) = (p_{10z} + p_{11z}) (p_{01z} + p_{11z})
    $$
    $$
        p_{11z} p_{00z} + p_{11z} p_{01z} + p_{11z} p_{10z} + p_{11z} p_{11z} = p_{10z} p_{01z} + p_{10z}p_{11z} + p_{11z}p_{01z} +
        p_{11z} p_{11z}
    $$
    $$
        p_{11z} p_{00z} = p_{10z} p_{01z}
    $$
    Таким образом, из условной независимости $X$ и $Y$ при условии $Z$ следует
    $p_{00z}p_{11z}=p_{01z}p_{10z}$, где $z=\overline{0,1}$.

    Доказательство в обратную сторону проводится аналогично.
\end{proof}
Приведем пример случайного вектора $(X,Y,Z)^T$ с трехмерным распределением Бернулли, в котором $X \ci Y \mid Z$.
\begin{example}
    Пусть $(X,Y,Z)^T$ имеет трехмерное распределение Бернулли с вероятностями
    $p_{000}=0.15$, $p_{001}=0.1$, $p_{010}=0.3$, $p_{011}=0.1$, $p_{100}=0.05$, $p_{101}=0.1$,
    $p_{110}=0.1$, $p_{111}=0.1$.
    Заметим, что:
    $$p_{000}p_{110}=p_{010}p_{100}=0.015$$ $$p_{001}p_{111}=p_{011}p_{101}=0.01$$
    Значит из теоремы \ref{thm1} следует, что $X \ci Y \mid Z$.
\end{example}
