\section{Введение}

\begin{definition}
    Случайный вектор $(X,Y,Z)^T$ имеет трехмерное распределение Бернулли,
    если множество его возможных значений
    $$
        \begin{pmatrix}
            0 \\
            0 \\
            0
        \end{pmatrix},
        \begin{pmatrix}
            0 \\
            0 \\
            1
        \end{pmatrix},
        \begin{pmatrix}
            0 \\
            1 \\
            0
        \end{pmatrix}, \ldots, \begin{pmatrix}
            1 \\
            1 \\
            1
        \end{pmatrix}
    $$ и заданы вероятности
    $$P(X=x,Y=y,Z=z)=p_{xyz} \geq 0, \quad \sum_{x=0}^{1}\sum_{y=0}^{1}\sum_{z=0}^{1}p_{xyz}=1$$
\end{definition}

\begin{definition}
    Пусть $(X,Y,Z)^T$ -- дискретный случайный вектор.
    Говорят, что случайные величины $X$ и $Y$ условно независимы при условии $Z$,
    и пишут $X \ci Y \mid Z$ если
    для любых $x,y$ и $z$, такого что $P(Z=z)>0$, выполнено:
    $$
        P(X=x, Y=y \mid Z = z) = P(X=x \mid Z = z) P(Y=y \mid Z = z)
    $$
\end{definition}

\begin{theorem}\label{thm1}
    Пусть $(X,Y,Z)^T$ -- случайный вектор, имеющий трехмерное распределение Бернулли, и $P(Z=0)>0$.
    Случайные величины $X$ и $Y$ условно независимы при условии $Z$ тогда и только тогда, когда
    $p_{00z}p_{11z}=p_{01z}p_{10z}$, где $z=0,1$.
\end{theorem}

\begin{proof}
    Пусть $X \ci Y \mid Z$. Значит, для любых $x=0,1$, $y=0,1$ и $z=0,1$ выполнено условие:
    $$
        P(X=x, Y=y \mid Z = z) = P(X=x \mid Z = z) P(Y=y \mid Z = z)
    $$
    После домножения на $P(Z=z)^2$ получаем эквивалентное условие:
    $$
        P(X=x,Y=y,Z=z)P(Z=z)=P(X=x,Z=z)P(Y=y,Z=z)
    $$
    Найдем маргинальное распределение случайной величины $Z$:
    $$
        P(Z=z)=\sum_{x=0}^{1} \sum_{y=0}^{1} p_{xyz} = p_{00z} + p_{01z} + p_{10z} + p_{11z}
    $$
    Найдем маргинальные распределения $(X,Z)^T$ и $(Y,Z)^T$:
    $$
        P(X=x, Z=z) = \sum_{y=0}^{1} p_{xyz} = p_{x0z} + p_{x1z}
    $$
    $$
        P(Y=y, Z=z) = \sum_{x=0}^{1} p_{xyz} = p_{0yz} + p_{1yz}
    $$
    Тогда условие условной независимости перепишем в следующем виде:
    $$
        p_{xyz} (p_{00z} + p_{01z} + p_{10z} + p_{11z}) = (p_{x0z} + p_{x1z}) (p_{0yz} + p_{1yz})
    $$
    Это условие выполняется для всех $x=0,1$, $y=0,1$, $z=0,1$.
    Пусть $z$ фиксировано.
    Если $x=0$ и $y=0$, то:
    $$
        p_{00z} (p_{00z} + p_{01z} + p_{10z} + p_{11z}) = (p_{00z} + p_{01z}) (p_{00z} + p_{10z})
    $$
    $$
        p_{00z} p_{00z} + p_{00z} p_{01z} + p_{00z} p_{10z} + p_{00z} p_{11z} =
        p_{00z} p_{00z} + p_{00z} p_{10z} + p_{01z} p_{00z} + p_{01z} p_{10z}
    $$
    $$
        p_{00z} p_{11z} = p_{01z} p_{10z}
    $$
    Если $x=0$ и $y=1$, то:
    $$
        p_{01z} (p_{00z} + p_{01z} + p_{10z} + p_{11z}) = (p_{00z} + p_{01z}) (p_{01z} + p_{11z})
    $$
    $$
        p_{01z}p_{00z} + p_{01z}p_{01z} + p_{01z}p_{10z} + p_{01z}p_{11z} =
        p_{00z}p_{01z} + p_{00z} p_{11z} + p_{01z} p_{01z} + p_{01z} p_{11z}
    $$
    $$
        p_{01z}p_{10z}=p_{00z} p_{11z}
    $$
    Если $x=1$ и $y=0$, то:
    $$
        p_{10z} (p_{00z} + p_{01z} + p_{10z} + p_{11z}) = (p_{10z} + p_{11z}) (p_{00z} + p_{10z})
    $$
    $$
        p_{10z} p_{00z} + p_{10z} p_{01z} + p_{10z} p_{10z} + p_{10z} p_{11z} = p_{10z}p_{00z} + p_{10z}p_{10z} + p_{11z}p_{00z} + p_{11z}p_{10z}
    $$
    $$
        p_{10z} p_{01z} = p_{11z}p_{00z}
    $$
    Если $x=1$ и $y=1$, то:
    $$
        p_{11z} (p_{00z} + p_{01z} + p_{10z} + p_{11z}) = (p_{10z} + p_{11z}) (p_{01z} + p_{11z})
    $$
    $$
        p_{11z} p_{00z} + p_{11z} p_{01z} + p_{11z} p_{10z} + p_{11z} p_{11z} = p_{10z} p_{01z} + p_{10z}p_{11z} + p_{11z}p_{01z} +
        p_{11z} p_{11z}
    $$
    $$
        p_{11z} p_{00z} = p_{10z} p_{01z}
    $$
    Таким образом, из условной независимости $X$ и $Y$ при условии $Z$ следует
    $p_{00z}p_{11z}=p_{01z}p_{10z}$, где $z=0,1$.

    Доказательство в обратную сторону проводится аналогично.
\end{proof}

\begin{example}
    Пусть $(X,Y,Z)^T$ имеет трехмерное распределение Бернулли с вероятностями
    $p_{000}=0.15$, $p_{001}=0.1$, $p_{010}=0.3$, $p_{011}=0.1$, $p_{100}=0.05$, $p_{101}=0.1$,
    $p_{110}=0.1$, $p_{111}=0.1$.
    Заметим, что:
    $$p_{000}p_{110}=p_{010}p_{100}=0.015$$ $$p_{001}p_{111}=p_{011}p_{101}=0.01$$
    Значит из теоремы \ref{thm1} следует, что $X \ci Y \mid Z$.
\end{example}
