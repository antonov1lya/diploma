\subsection{Условная независимость в трехмерном распределение Бернулли}\label{ci_and_bernoulli}

Определим трехмерное распределение Бернулли \cite{Dai2013, Teugels1990}.
\begin{definition}
    Случайный вектор $(X,Y,Z)^T$ имеет трехмерное распределение Бернулли,
    если множество его возможных значений:
    $$
        \begin{pmatrix}
            0 \\
            0 \\
            0
        \end{pmatrix},
        \begin{pmatrix}
            0 \\
            0 \\
            1
        \end{pmatrix},
        \begin{pmatrix}
            0 \\
            1 \\
            0
        \end{pmatrix}, \ldots, \begin{pmatrix}
            1 \\
            1 \\
            1
        \end{pmatrix}
    $$ и заданы $\Prb(X=x,Y=y,Z=z)=p_{xyz} \geq 0,  \sum_{x=0}^1 \sum_{y=0}^1 \sum_{z=0}^1 p_{xyz} =1$.
\end{definition}
В настоящей работе будут рассматриваться
только случайные векторы $(X,Y,Z)^T$, в которых
$p_{xyz}>0$ при всех 
$x \in \{0,1\}$, $y\in \{0,1\}$, $z\in \{0,1\}$.

Приведем определение понятия условной независимости \cite{Lauritzen1996}.
\begin{definition}\label{cond_ind_def}
    Пусть $(X,Y,Z)^T$ -- дискретный случайный вектор.
    Говорят, что случайные величины $X$ и $Y$ условно независимы при условии $Z$,
    и пишут $X \ci Y \mid Z$, если:
    $$
    \Prb(X=x, Y=y \mid Z = z) = \Prb(X=x \mid Z = z) \Prb(Y=y \mid Z = z)
    $$
    при любых $x,y$ и $z$ для которого $\Prb(Z=z)>0$.
\end{definition}
Сформулируем критерий условной независимости в трехмерном
распределении Бернулли.
\begin{theorem}\label{thm1}
    Пусть $(X,Y,Z)^T$ -- случайный вектор, имеющий трехмерное распределение Бернулли, в котором $0<\Prb(Z=0)<1$.
    Случайные величины $X$ и $Y$ условно независимы при условии $Z$ тогда и только тогда, когда
    $$p_{00z}p_{11z}=p_{01z}p_{10z}$$ для всех $z\in \{0,1\}$.
\end{theorem}
\begin{proof}
    Пусть $X \ci Y \mid Z$. Значит, для любых $x\in \{0,1\}$, $y\in \{0,1\}$ и $z\in \{0,1\}$ выполнено условие:
    \begin{equation}\label{ci_cond}
        \Prb(X=x, Y=y \mid Z = z) = \Prb(X=x \mid Z = z) \Prb(Y=y \mid Z = z)
    \end{equation}
    После домножения \eqref{ci_cond} на $\Prb(Z=z)^2>0$ получаем эквивалентное условие:
    \begin{equation}\label{ci_cond2}
        \Prb(X=x,Y=y,Z=z)\Prb(Z=z)=\Prb(X=x,Z=z)\Prb(Y=y,Z=z)
    \end{equation}
    Найдем следующие вероятности:
    $$
        \Prb(X=x, Z=z) = p_{x0z} + p_{x1z},\;  \Prb(Y=y, Z=z) = p_{0yz} + p_{1yz}
    $$
    $$
        \Prb(Z=z)= p_{00z} + p_{01z} + p_{10z} + p_{11z}
    $$
    Тогда условие \eqref{ci_cond2} перепишем в следующем виде:
    $$
        p_{xyz} (p_{00z} + p_{01z} + p_{10z} + p_{11z}) = (p_{x0z} + p_{x1z}) (p_{0yz} + p_{1yz})
    $$
    Это условие выполняется для всех $x \in \{0,1\}$, $y\in \{0,1\}$, $z\in \{0,1\}$.
    Пусть $z$ фиксировано.
    Если $x=0$ и $y=0$, то:
    $$
        p_{00z} (p_{00z} + p_{01z} + p_{10z} + p_{11z}) = (p_{00z} + p_{01z}) (p_{00z} + p_{10z})
    \Leftrightarrow
        p_{00z} p_{11z} = p_{01z} p_{10z}
    $$
    Если $x=0$ и $y=1$, то:
    $$
        p_{01z} (p_{00z} + p_{01z} + p_{10z} + p_{11z}) = (p_{00z} + p_{01z}) (p_{01z} + p_{11z})
    \Leftrightarrow
    p_{00z} p_{11z} = p_{01z} p_{10z}
    $$
    Если $x=1$ и $y=0$, то:
    $$
        p_{10z} (p_{00z} + p_{01z} + p_{10z} + p_{11z}) = (p_{10z} + p_{11z}) (p_{00z} + p_{10z})
    \Leftrightarrow
    p_{00z} p_{11z} = p_{01z} p_{10z}
    $$
    Если $x=1$ и $y=1$, то:
    $$
        p_{11z} (p_{00z} + p_{01z} + p_{10z} + p_{11z}) = (p_{10z} + p_{11z}) (p_{01z} + p_{11z})
    \Leftrightarrow
    p_{00z} p_{11z} = p_{01z} p_{10z}
    $$
    Таким образом, из $X \ci Y \mid Z$ следует
    $p_{00z}p_{11z}=p_{01z}p_{10z}$ для всех $z \in \{0,1\}$.

    Поскольку в вышеприведенных рассуждениях все переходы равносильные,
    мы также доказали, что из условия $p_{00z}p_{11z}=p_{01z}p_{10z}$ для всех $z \in \{0,1\}$
    следует $X \ci Y \mid Z$.
\end{proof}
Покажем, что существует случайный вектор $(X,Y,Z)^T$ с трехмерным распределением Бернулли, в котором $X \ci Y \mid Z$.
\begin{example}
    Пусть $(X,Y,Z)^T$ имеет трехмерное распределение Бернулли с вероятностями
    $p_{000}=0.15$, $p_{001}=0.1$, $p_{010}=0.3$, $p_{011}=0.1$, $p_{100}=0.05$, $p_{101}=0.1$,
    $p_{110}=0.1$, $p_{111}=0.1$.
    Заметим, что:
    $$p_{000}p_{110}=p_{010}p_{100}=0.015$$ $$p_{001}p_{111}=p_{011}p_{101}=0.01$$
    Тогда из \autoref{thm1} следует, что $X \ci Y \mid Z$.
\end{example}
